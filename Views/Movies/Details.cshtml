@model Fall2025_Project3_gbward.ViewModels.MovieDetailsViewModel

@{
ViewData["Title"] = "Movie Details";
}

<h1>@Model.Movie.Title</h1>

<div class="row">
	<div class="col-md-8">
		<h4>Movie Information</h4>
		<hr />
		<dl class="row">
			<dt class="col-sm-3">Title</dt>
			<dd class="col-sm-9">@Model.Movie.Title</dd>

			<dt class="col-sm-3">IMDB Link</dt>
			<dd class="col-sm-9">
				@if (!string.IsNullOrEmpty(Model.Movie.ImdbLink))
				{
				<a href="@Model.Movie.ImdbLink" target="_blank">View on IMDB</a>
				}
				else
				{
				<span>N/A</span>
				}
			</dd>

			<dt class="col-sm-3">Genre</dt>
			<dd class="col-sm-9">@(Model.Movie.Genre ?? "N/A")</dd>

			<dt class="col-sm-3">Year</dt>
			<dd class="col-sm-9">@(Model.Movie.Year ?? "N/A")</dd>
		</dl>

		@if (Model.Movie.Poster != null && Model.Movie.Poster.Length > 0)
		{
		<div class="mb-3">
			<strong>Poster:</strong><br />
			<img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.Movie.Poster)" alt="Movie Poster"
				style="max-width: 300px; max-height: 450px;" class="img-thumbnail" />
		</div>
		}

		<h4 class="mt-4">Cast</h4>
		@if (Model.Movie.MovieActors != null && Model.Movie.MovieActors.Any())
		{
		<ul>
			@foreach (var ma in Model.Movie.MovieActors)
			{
			<li>
				<a asp-controller="Actors" asp-action="Details" asp-route-id="@ma.Actor.Id">
					@ma.Actor.Name
				</a>
			</li>
			}
		</ul>
		}
		else
		{
		<p>No actors listed for this movie.</p>
		}
	</div>
</div>

<div class="row mt-4">
	<div class="col-md-12">
		<h3>AI-Generated Reviews and Sentiment Analysis</h3>
		<h5>Overall Sentiment: <span class="badge @(Model.SentimentLabel == " Positive" ? "bg-success" :
				Model.SentimentLabel=="Negative" ? "bg-danger" : "bg-secondary" )">
				@Model.SentimentLabel (@Model.AverageSentiment.ToString("F3"))
			</span></h5>
		<hr />

		@if (Model.Reviews != null && Model.Reviews.Any())
		{
		<table class="table table-striped table-hover">
			<thead>
				<tr>
					<th style="width: 70%">Review</th>
					<th style="width: 30%">Sentiment</th>
				</tr>
			</thead>
			<tbody>
				@foreach (var review in Model.Reviews)
				{
				<tr>
					<td>@review.Review</td>
					<td>
						<span class="badge @(review.SentimentLabel == " Positive" ? "bg-success"
							: review.SentimentLabel=="Negative" ? "bg-danger"
							: "bg-secondary" )">
							@review.SentimentLabel (@review.CompoundScore.ToString("F3"))
						</span>
					</td>
				</tr>
				}
			</tbody>
		</table>
		}
		else
		{
		<p>No reviews available.</p>
		}
	</div>
</div>

<div class="mt-3">
	<a asp-action="Edit" asp-route-id="@Model.Movie.Id" class="btn btn-primary">Edit</a>
	<a asp-action="Index" class="btn btn-secondary">Back to List</a>
</div>
